# Crossworlds

An autonomous, persistent simulated world where agents live, interact, make decisions, and generate emergent narratives. The simulation runs continuously on a cloud server, and users can check in periodically to see what has unfolded.

This is a petri dish, not a game — emergence over scripting.

**Live at [crossworlds.xyz](https://crossworlds.xyz)**

## What Is This?

Crossworlds simulates a medieval-fantasy world populated by thousands of agents on a hex grid. Agents have needs (survival, safety, belonging, esteem, purpose), occupations, skills, relationships, and a coherence model rooted in the Wheeler Emanationist Cosmology — a mathematical framework where all tuning constants derive from the golden ratio (Φ).

The world runs 24/7. Agents farm, mine, craft, trade, form factions, elect leaders, start revolutions, found new settlements, and occasionally receive LLM-powered visions. A weekly newspaper is generated by AI. Nobody is steering the ship — the world simply runs, and you can check in to see what happened.

## Architecture

**Language:** Go — for its built-in HTTP server, goroutines, static typing, and fast development velocity.

### Tiered Agent Cognition

| Tier | % of Agents | Method |
|------|-------------|--------|
| 0 | ~95% | Rule-based state machines driven by Maslow needs hierarchy |
| 1 | ~4% | Archetype-guided — Haiku generates behavioral templates weekly |
| 2 | <1% (~20-50 named characters) | Individual LLM-powered decisions via Claude Haiku |

### Closed Economy

The economy is crown-conserving. An order-matched market engine ensures every crown that enters a seller's pocket leaves a buyer's pocket. Merchant trade and Tier 2 agent trade flow through settlement treasuries. Taxes and wealth decay act as sinks. A small number of throttled mints (journeyman labor, laborer wages) remain as the only source of new crowns.

### External Entropy

- **Real weather** via OpenWeatherMap → in-world weather effects
- **True randomness** from random.org for critical stochastic events
- **LLM cognition** via Claude Haiku for Tier 2 decisions, oracle visions, and newspaper generation

### Claude Gardener

An autonomous steward process that periodically observes the world state via the API, analyzes it with Claude Haiku, and applies gentle interventions through the admin API — nudging the world toward health without overriding emergence.

## API

The world exposes a public read-only API. Anyone can observe:

```
GET  /api/v1/status          World clock, population, economy summary
GET  /api/v1/settlements     All settlements with governance and health
GET  /api/v1/settlement/:id  Settlement detail: market, agents, factions, events
GET  /api/v1/agents          Notable Tier 2 characters (or ?tier=0 for all)
GET  /api/v1/agent/:id       Full agent detail
GET  /api/v1/agent/:id/story AI-generated biography
GET  /api/v1/events          Recent world events (?limit=N)
GET  /api/v1/newspaper       Weekly AI-generated newspaper
GET  /api/v1/factions        Factions with influence and treasury
GET  /api/v1/economy         Prices, trade volume, Gini coefficient
GET  /api/v1/map             Bulk map: all hexes with terrain and resources
GET  /api/v1/map/:q/:r       Single hex detail
GET  /api/v1/stats           Aggregate statistics
GET  /api/v1/stats/history   Time-series stats (?from=TICK&to=TICK&limit=N)
GET  /api/v1/social          Social network overview
```

Base URL: `https://api.crossworlds.xyz`

## Quick Start

```bash
# Build
go build -o worldsim ./cmd/worldsim

# Run (starts with a freshly generated world)
./worldsim

# The API is available at http://localhost:80/api/v1/status
```

Environment variables:
- `WORLDSIM_ADMIN_KEY` — Bearer token for admin endpoints
- `ANTHROPIC_API_KEY` — Enables LLM features (Tier 2 cognition, newspaper, biographies)
- `WEATHER_API_KEY` — OpenWeatherMap key for real weather integration
- `WEATHER_LOCATION` — Location string (e.g., `"San Diego,US"`)
- `RANDOM_ORG_API_KEY` — True randomness for critical events
- `CORS_ORIGINS` — Comma-separated allowed origins

## Project Structure

```
cmd/worldsim/          Entry point
cmd/gardener/          Gardener entry point
internal/
  phi/                 Emanation constants (Φ-derived)
  world/               Hex grid, terrain, map generation
  agents/              Agent types, needs, soul/coherence, behavior
  economy/             Good types, market entries, price resolution
  social/              Settlements, governance, infrastructure
  engine/              Tick engine, simulation loop, market, production,
                       cognition, factions, population, crime, seasons
  llm/                 Claude Haiku integration (cognition, oracle,
                       newspaper, narration, archetypes, biography)
  weather/             OpenWeatherMap client
  entropy/             random.org client
  persistence/         SQLite save/load
  gardener/            Observe → Decide → Act autonomous steward
  api/                 HTTP API server
deploy/                Deployment scripts, systemd units, config
docs/                  Design specs, operations, tuning changelogs
```

## Design Documents

| Document | Contents |
|----------|----------|
| `docs/worldsim-design.md` | Complete design spec (~1,500 lines, source of truth) |
| `docs/00-project-vision.md` | Design pillars and philosophy |
| `docs/02-operations.md` | Server ops, security, API reference |
| `docs/05-claude-gardener.md` | Gardener design |
| `docs/07-closed-economy-implementation.md` | Closed economy design |
| `docs/08-closed-economy-changelog.md` | Post-deploy monitoring notes |

## The Wheeler Framework

All tuning constants in Crossworlds derive from the golden ratio (Φ = 1.618...). The emanation hierarchy:

| Constant | Value | Role |
|----------|-------|------|
| Being (Φ) | 1.618 | Cooperation bonus, price ceiling multiplier |
| Psyche (Φ^-1) | 0.618 | Profit threshold, coherence midpoint |
| Matter (Φ^-2) | 0.382 | Emigrant fraction, price floor multiplier |
| Agnosis (Φ^-3) | 0.236 | Tax rate, decay rate, coherence floor |
| Totality (Φ^2) | 2.618 | Price ceiling, capacity scaling |

Agents have a coherence value (citta) that determines their State of Being: Embodied → Centered → Liberated. Liberated agents receive oracle visions. The framework ensures agents can move through suffering, not be trapped in it.

## License

This is a public research project. See the repository for details.
